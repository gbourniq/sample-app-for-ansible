# This playbook contains docker actions that will be run on "remote" host.

- name: Deleting repo folder if exists
  become: yes
  file:
    path: "{{ repo_folder }}"
    state: absent
  tags:
    - clone-repo

- name: Create a docker_deployment directory if it does not exist
  file:
    path: "{{ repo_folder }}"
    state: directory
    mode: '0755'
  tags:
    - clone-repo

- name: Recursively change ownership of a directory
  file:
    path: "{{ repo_folder }}"
    state: directory
    recurse: yes
    owner: ubuntu
    group: ubuntu
  tags:
    - clone-repo

- name: Clone github repo
  become: no
  git:
    repo: https://{{ github_user }}:{{ github_pwd }}@github.com/{{ github_user }}/{{ repo_name }}.git
    version: master
    dest: "{{ repo_folder }}"
    update: yes
  tags:
    - clone-repo