# This playbook contains docker actions that will be run on "remote" host.

- name: Destroying build environment and Removing dangling images...
  shell: cd {{ repo_folder }} && make clean
  register: cmdln
  failed_when: "cmdln.rc == 2"

- name: Logging in to Docker registry...
  shell: cd {{ repo_folder }} && make login
  register: cmdln
  failed_when: "cmdln.rc == 2"

- name: Pulling release images from Docker registry and starting services...
  shell: cd {{ repo_folder }} && make prod
  register: cmdln
  failed_when: "cmdln.rc == 2"